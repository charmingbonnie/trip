<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ±äº¬ãƒ»é¦–çˆ¾ 11æ—¥é›™åŸèªŒ</title>
    <!-- å¼•å…¥ Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Shippori+Mincho:wght@400;700&display=swap" rel="stylesheet">
    <!-- å¼•å…¥ FontAwesome åœ–æ¨™ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-color: #F9F7F2; /* å’Œç´™ç±³è‰² */
            --primary-color: #2C3E50; /* æ·±è—ç° */
            --accent-color: #C85554; /* æ—¥ç³»æœ±ç´… */
            --card-bg: #FFFFFF;
            --text-color: #4A4A4A;
            --secondary-text: #888888;
            --shadow: 0 4px 20px rgba(0,0,0,0.05);
            --radius: 16px;
            --sea-color: #0077be;
            --land-color: #e91e63;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: 'Shippori Mincho', 'Noto Sans TC', serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            padding-bottom: 90px; /* å¢åŠ åº•éƒ¨ç©ºé–“çµ¦å°èˆª */
        }

        /* iOS æŒ‰éˆ•å¼·åˆ¶å„ªåŒ– */
        button {
            border: none; background: none; padding: 0; margin: 0;
            font-family: inherit; cursor: pointer; -webkit-appearance: none; appearance: none; outline: none;
        }

        /* --- Hero Section --- */
        .hero {
            padding: 40px 24px 20px;
            background: linear-gradient(180deg, rgba(255,255,255,0) 0%, var(--bg-color) 100%), url('https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?q=80&w=1000&auto=format&fit=crop');
            background-size: cover; background-position: center; height: 280px;
            display: flex; flex-direction: column; justify-content: flex-end; position: relative;
        }
        .hero-date {
            font-size: 0.9rem; letter-spacing: 2px; color: var(--primary-color); font-weight: bold;
            background: rgba(255,255,255,0.8); display: inline-block; padding: 4px 12px;
            border-radius: 20px; margin-bottom: 8px; backdrop-filter: blur(4px);
        }
        .hero-title { font-size: 1.8rem; font-weight: 700; line-height: 1.3; color: var(--primary-color); margin-bottom: 10px; }
        .weather-badge {
            position: absolute; top: 20px; right: 20px; background: white; padding: 8px 12px;
            border-radius: 12px; box-shadow: var(--shadow); font-size: 0.85rem; display: flex; align-items: center; gap: 6px;
        }

        /* --- Day Selector --- */
        .day-nav {
            display: flex; overflow-x: auto; padding: 10px 20px; gap: 12px;
            scrollbar-width: none; position: sticky; top: 0; background: var(--bg-color); z-index: 10; border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .day-nav::-webkit-scrollbar { display: none; }
        .day-chip {
            flex: 0 0 auto; padding: 8px 16px; border-radius: 24px; border: 1px solid #ddd;
            font-family: 'Noto Sans TC', sans-serif; font-size: 0.9rem; color: var(--secondary-text);
            transition: all 0.2s ease; background-color: transparent;
        }
        .day-chip.active { background-color: var(--primary-color); color: white; border-color: var(--primary-color); box-shadow: 0 4px 10px rgba(44, 62, 80, 0.3); }

        /* --- Timeline --- */
        .timeline-container { padding: 20px 24px; position: relative; }
        .timeline-item { display: flex; gap: 16px; margin-bottom: 24px; position: relative; }
        .timeline-item::before { content: ''; position: absolute; left: 24px; top: 24px; bottom: -24px; width: 1px; background: #E0E0E0; z-index: 0; }
        .timeline-item:last-child::before { display: none; }
        .time-col { flex: 0 0 50px; text-align: right; font-size: 0.85rem; font-weight: 600; color: var(--secondary-text); padding-top: 4px; font-family: 'Noto Sans TC'; z-index: 1; background: var(--bg-color); }
        .card-col { flex: 1; }
        .event-card {
            background: var(--card-bg); border-radius: var(--radius); padding: 16px;
            box-shadow: var(--shadow); position: relative; overflow: hidden; border-left: 4px solid transparent;
        }
        .event-card.flight { border-left-color: #3498db; }
        .event-card.hotel { border-left-color: #9b59b6; }
        .event-card.food { border-left-color: #e67e22; }
        .event-card.spot { border-left-color: var(--accent-color); }
        .event-card.transport { border-left-color: #2ecc71; }
        
        .card-title { font-size: 1.1rem; font-weight: 700; color: var(--primary-color); margin-bottom: 4px; }
        .card-desc { font-size: 0.9rem; color: var(--text-color); line-height: 1.6; margin-bottom: 8px; font-family: 'Noto Sans TC'; }
        .card-desc ul { padding-left: 20px; margin: 0; }
        .card-desc li { margin-bottom: 4px; }
        
        .traffic-tag { display: inline-block; background-color: #E8F5E9; color: #2E7D32; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; margin-top: 6px; font-weight: 500; }
        .action-row { display: flex; gap: 12px; margin-top: 12px; border-top: 1px dashed #eee; padding-top: 8px; flex-wrap: wrap;}
        .icon-btn { text-decoration: none; background: none; border: none; color: var(--secondary-text); font-size: 0.95rem; cursor: pointer; display: flex; align-items: center; gap: 4px; font-family: 'Noto Sans TC'; padding: 4px 8px; border-radius: 8px; transition: background 0.2s; }
        .icon-btn:active { background: #f0f0f0; }

        /* --- Memo Section --- */
        .memo-container {
            margin: 20px 24px;
            background: #fff;
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            border-top: 4px solid #f1c40f;
        }
        .memo-title {
            font-size: 1rem; font-weight: bold; color: var(--primary-color); margin-bottom: 10px;
            display: flex; align-items: center; gap: 8px;
        }
        .memo-textarea {
            width: 100%;
            height: 100px;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
            font-family: 'Noto Sans TC';
            font-size: 0.95rem;
            resize: none;
            background-color: #fafafa;
        }
        .memo-textarea:focus { outline: none; border-color: #f1c40f; background-color: #fff; }

        /* --- Shopping List Styles --- */
        .shopping-container { padding: 24px; }
        .shopping-input-group {
            display: flex; gap: 10px; margin-bottom: 20px;
        }
        .shopping-input {
            flex: 1; padding: 12px; border: 2px solid #eee; border-radius: 12px; font-size: 1rem;
        }
        .shopping-add-btn {
            background: var(--accent-color); color: white; border: none; padding: 0 20px;
            border-radius: 12px; font-weight: bold; cursor: pointer;
        }
        .shopping-list { list-style: none; padding: 0; }
        .shopping-item {
            background: white; padding: 15px; margin-bottom: 10px; border-radius: 12px;
            display: flex; align-items: center; gap: 12px; box-shadow: var(--shadow);
            transition: all 0.2s;
        }
        .shopping-item.checked { opacity: 0.6; }
        .shopping-item.checked .item-text { text-decoration: line-through; color: #999; }
        .checkbox {
            width: 24px; height: 24px; border: 2px solid #ddd; border-radius: 6px;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
        }
        .checkbox.checked { background: var(--accent-color); border-color: var(--accent-color); color: white; }
        .item-text { flex: 1; font-size: 1rem; font-family: 'Noto Sans TC'; }
        .delete-btn { color: #ccc; font-size: 1.1rem; cursor: pointer; padding: 5px; }
        .delete-btn:hover { color: #e74c3c; }

        /* --- DAS Styles --- */
        .das-header { background: white; padding: 24px; border-radius: 0 0 20px 20px; box-shadow: var(--shadow); margin-bottom: 20px; position: sticky; top: 0; z-index: 20; }
        .speech-bubble { background: #EBF8FF; border-left: 5px solid var(--sea-color); padding: 15px; border-radius: 8px; margin-bottom: 15px; }
        .speech-text-jp { font-size: 1.1rem; font-weight: bold; color: #333; margin-bottom: 5px; font-family: 'Noto Sans JP', sans-serif; }
        .speech-text-zh { font-size: 0.85rem; color: #666; }
        .park-switcher { display: flex; background: #eee; border-radius: 30px; padding: 4px; }
        .park-btn { flex: 1; text-align: center; padding: 10px; border-radius: 25px; font-size: 0.95rem; font-weight: bold; cursor: pointer; transition: 0.3s; color: #888; }
        .park-btn.active-sea { background: white; color: var(--sea-color); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .park-btn.active-land { background: white; color: var(--land-color); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .das-list { padding: 0 20px; }
        .das-card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 16px; box-shadow: var(--shadow); border: 1px solid #f0f0f0; }
        .das-jp-name { font-size: 1.3rem; font-weight: 900; color: #222; margin-bottom: 8px; line-height: 1.4; font-family: sans-serif; }
        .das-sub-info { font-size: 0.85rem; color: #666; margin-bottom: 2px; font-family: 'Noto Sans TC'; }

        /* --- Info Styles --- */
        .info-section { padding: 24px; display: none; }
        .info-group-title { font-family: 'Shippori Mincho'; font-size: 1.4rem; font-weight: bold; color: var(--primary-color); margin: 30px 0 15px 0; padding-left: 10px; border-left: 4px solid var(--accent-color); }
        .info-group-title:first-child { margin-top: 0; }
        .info-card { background: white; border-radius: var(--radius); padding: 20px; margin-bottom: 16px; box-shadow: var(--shadow); border: 1px solid #f5f5f5; }
        .info-header { border-bottom: 1px solid #eee; padding-bottom: 12px; margin-bottom: 12px; font-weight: bold; color: var(--primary-color); font-size: 1.1rem; display: flex; justify-content: space-between; align-items: center; }
        .info-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.95rem; }
        .info-label { color: #888; }
        .info-val { font-weight: 500; text-align: right; color: #333; max-width: 65%; }
        .copy-btn { background: #f0f0f0; color: #555; border: none; padding: 6px 12px; border-radius: 12px; font-size: 0.8rem; cursor: pointer; }
        .copy-btn.set { background-color: var(--accent-color); color: white; }

        /* --- Bottom Nav --- */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: white; height: 80px; display: flex; justify-content: space-around; align-items: flex-start; padding-top: 12px; box-shadow: 0 -4px 20px rgba(0,0,0,0.05); z-index: 100; }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #ccc; font-size: 0.75rem; cursor: pointer; transition: color 0.3s; width: 20%; background-color: transparent; }
        .nav-item i { font-size: 1.3rem; margin-bottom: 5px; }
        .nav-item.active { color: var(--primary-color); }
        .nav-item.das-active { color: var(--sea-color); }

        /* --- Modal --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(3px); }
        .modal-content { background: white; width: 85%; max-width: 400px; padding: 24px; border-radius: 20px; position: relative; animation: slideUp 0.3s ease-out; max-height: 85vh; overflow-y: auto; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .close-modal { position: absolute; top: 15px; right: 15px; font-size: 1.5rem; cursor: pointer; color: #999; }
        
        /* Input in Modal */
        .modal-label { display: block; margin-top: 15px; font-weight: bold; color: #555; font-size: 0.9rem; }
        .modal-input { width: 100%; padding: 12px; margin-top: 5px; border: 2px solid #ddd; border-radius: 8px; font-size: 1rem; }
        .modal-file-label { display: block; margin-top: 10px; padding: 15px; border: 2px dashed #ccc; border-radius: 8px; text-align: center; color: #888; cursor: pointer; }
        .modal-file-label:hover { background: #f9f9f9; }
        .preview-img { width: 100%; margin-top: 10px; border-radius: 8px; display: none; border: 1px solid #ddd; }
        .modal-save-btn { width: 100%; padding: 12px; background: var(--primary-color); color: white; border-radius: 8px; font-size: 1rem; font-weight: bold; margin-top: 20px; }
        .modal-clear-btn { background: transparent; color: #999; font-size: 0.8rem; margin-top: 15px; text-decoration: underline; text-align: center; width: 100%; display: block; }
        
        .hidden { display: none !important; }

    </style>
</head>
<body>

    <!-- VIEW 1: ITINERARY -->
    <div id="view-itinerary">
        <div class="hero">
            <div class="weather-badge"><i class="fa-solid fa-cloud-sun"></i> <span>14Â°C</span></div>
            <div class="hero-date" id="hero-date">DAY 1 â€¢ 11/26</div>
            <div class="hero-title" id="hero-location"></div>
        </div>
        <div class="day-nav" id="day-nav-container"></div>
        <div class="timeline-container" id="timeline-content"></div>
        <!-- Memo Section (Injected via JS) -->
    </div>

    <!-- VIEW 2: DAS CARD -->
    <div id="view-das" class="hidden">
        <div class="das-header">
            <h2 style="margin-bottom:15px; text-align:center; font-family:'Shippori Mincho'">DAS æºé€šå¡</h2>
            <div class="speech-bubble">
                <div class="speech-text-jp">ã™ã¿ã¾ã›ã‚“ã€DASã‚’åˆ©ç”¨ã—ãŸã„ã§ã™ã€‚<br>ã“ã®ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚</div>
                <div class="speech-text-zh">ä¸å¥½æ„æ€ï¼Œæˆ‘æƒ³ä½¿ç”¨ DASï¼Œéº»ç…©å¹«æˆ‘é ç´„é€™å€‹è¨­æ–½ã€‚</div>
            </div>
            <div class="park-switcher">
                <button type="button" class="park-btn active-sea" id="btn-sea" onclick="switchPark('sea')">ğŸŒŠ è¿ªå£«å°¼æµ·æ´‹</button>
                <button type="button" class="park-btn" id="btn-land" onclick="switchPark('land')">ğŸ° è¿ªå£«å°¼æ¨‚åœ’</button>
            </div>
        </div>
        <div class="das-list" id="das-list-container"></div>
        <div style="height:100px;"></div>
    </div>

    <!-- VIEW 3: SHOPPING LIST (New) -->
    <div id="view-shopping" class="hidden">
        <div style="padding: 24px 24px 0;">
            <h2 style="font-family:'Shippori Mincho'; color:var(--primary-color);">è³¼ç‰©æ¸…å–®</h2>
            <p style="color:#999; font-size:0.9rem;">è¨˜ä¸‹æƒ³è²·çš„æ±è¥¿ï¼Œæ‰“å‹¾ä»£è¡¨å·²è³¼å…¥</p>
        </div>
        <div class="shopping-container">
            <div class="shopping-input-group">
                <input type="text" id="new-item-input" class="shopping-input" placeholder="è¼¸å…¥å•†å“åç¨±...">
                <button class="shopping-add-btn" onclick="addShoppingItem()">æ–°å¢</button>
            </div>
            <ul id="shopping-list" class="shopping-list">
                <!-- JS Injected -->
            </ul>
        </div>
        <div style="height:100px;"></div>
    </div>

    <!-- VIEW 4: INFO -->
    <div id="view-info" class="hidden info-section">
        <h2 style="margin-bottom: 10px; font-family:'Shippori Mincho'; text-align:center;">æ—…ç¨‹è³‡è¨Šç¸½è¦½</h2>
        <p style="text-align:center; color:#999; font-size:0.8rem; margin-bottom:20px;">æ‰€æœ‰è³‡æ–™åƒ…å„²å­˜æ–¼æ‚¨çš„æ‰‹æ©Ÿï¼Œä¸å…¬é–‹ä¸Šå‚³</p>
        <div class="info-group-title">âœˆï¸ èˆªç­è³‡è¨Š</div>
        <div id="flight-info-container"></div>
        <div class="info-group-title">ğŸ¨ ä½å®¿è³‡è¨Š</div>
        <div id="hotel-info-container"></div>
        <div style="height:100px;"></div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-item active" onclick="switchView('itinerary', this)">
            <i class="fa-regular fa-calendar-days"></i> <span>è¡Œç¨‹</span>
        </button>
        <button class="nav-item" onclick="switchView('das', this)">
            <i class="fa-solid fa-person-walking-with-cane"></i> <span>DAS</span>
        </button>
        <button class="nav-item" onclick="switchView('shopping', this)">
            <i class="fa-solid fa-cart-shopping"></i> <span>è³¼ç‰©</span>
        </button>
        <button class="nav-item" onclick="switchView('info', this)">
            <i class="fa-solid fa-passport"></i> <span>è³‡è¨Š</span>
        </button>
        <button class="nav-item" onclick="openFullMap()">
            <i class="fa-solid fa-map-location-dot"></i> <span>åœ°åœ–</span>
        </button>
    </div>

    <!-- Secure Modal -->
    <div class="modal-overlay" id="secure-modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h3 id="modal-title" style="margin-bottom: 10px; color:var(--primary-color);">è³‡æ–™è¨­å®š</h3>
            <p style="font-size:0.8rem; color:#888; margin-bottom:15px;">æ­¤è³‡æ–™åƒ…å­˜åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­ã€‚</p>
            
            <label class="modal-label">æ–‡å­—å‚™è¨» / ä»£è™Ÿ</label>
            <input type="text" id="input-text" class="modal-input" placeholder="è¼¸å…¥ä»£è™Ÿæˆ–å‚™è¨»...">
            
            <label class="modal-label">åœ–ç‰‡ / QR Code</label>
            <label for="input-file" class="modal-file-label">
                <i class="fa-solid fa-image"></i> é»æ“Šé¸æ“‡åœ–ç‰‡ (å»ºè­°æˆªåœ–)
            </label>
            <input type="file" id="input-file" accept="image/*" style="display:none" onchange="previewImage(this)">
            <img id="img-preview" class="preview-img">
            <button class="modal-save-btn" onclick="saveData()">å„²å­˜åˆ°æ‰‹æ©Ÿ</button>
            <button class="modal-clear-btn" onclick="clearData()">æ¸…é™¤æ­¤ç­†è³‡æ–™</button>
        </div>
    </div>

    <script>
        // --- DATA: å®Œæ•´è¡Œç¨‹ ---
        const tripData = {
            days: [
                { day: 1, date: "11/26 (ä¸‰)", loc: "æ±äº¬ãƒ»æ·ºè‰", weather: "12Â°C", events: [
                    { time: "12:10", title: "æ¡ƒåœ’ T1 èµ·é£›", desc: "æ³°åœ‹ç…èˆª SL394", type: "flight", key: "flight_1" },
                    { time: "16:15", title: "æŠµé”æ±äº¬æˆç”° T1", desc: "å…¥å¢ƒã€é ˜è¡Œæ (åŒ—ç¿¼æŠµé”)", type: "flight", key: "entry_jp" },
                    { time: "17:04", title: "æ­ä¹˜ Access ç‰¹æ€¥", desc: "å¾€ç¾½ç”°æ–¹å‘ï¼Œç›´é”æŠ¼ä¸Šç«™ (ç´„58åˆ†)", type: "transport" },
                    { time: "18:10", title: "å’Œç·£ WAEN Check-in", desc: "1-Bedroom Apt (è¿‘æŠ¼ä¸Šç«™)", type: "hotel", key: "hotel_1" },
                    { time: "19:00", title: "æ·ºè‰æ–‡åŒ–è§€å…‰ä¸­å¿ƒ 8F", desc: "å…è²»å±•æœ›å°ï¼Œæ‹é›·é–€+æ™´ç©ºå¡”å¤œæ™¯", type: "spot" },
                    { time: "19:45", title: "æ·ºè‰å¯º", desc: "é›·é–€ã€äº”é‡å¡”é»ç‡ˆã€‚æ‹æ”ä»»å‹™ï¼šç¹ªé¦¬", type: "spot" },
                    { time: "20:30", title: "æ™´ç©ºå¡”åŸ Solamachi", desc: "æ™šé¤ã€å¯¶å¯å¤¢ä¸­å¿ƒã€å‰åœåŠ›", type: "food" }
                ]},
                { day: 2, date: "11/27 (å››)", loc: "æ±äº¬ãƒ»è¿ªå£«å°¼æµ·æ´‹", weather: "11Â°C", events: [
                    { time: "07:35", title: "æ­ä¹˜ Shuttle Bus", desc: "æ™´ç©ºå¡”å·´å£«ç«™ç›´é”è¿ªå£«å°¼", type: "transport" },
                    { time: "08:30", title: "å…¥åœ’", desc: "App ç¢ºèª DPAã€é–‹é€š DAS", type: "spot", key: "ticket_sea" },
                    { time: "11:40", title: "è–èª•ç¯€è¿è³“æœƒ", desc: "åœ°ä¸­æµ·æ¸¯ç£", type: "spot" },
                    { time: "13:10", title: "é”è²ç†ŠéŠè¡Œ", desc: "åœ°ä¸­æµ·æ¸¯ç£", type: "spot" },
                    { time: "14:15", title: "è–èª•ç¯€è¿è³“æœƒ", desc: "åœ°ä¸­æµ·æ¸¯ç£", type: "spot" },
                    { time: "15:25", title: "é”è²ç†ŠéŠè¡Œ", desc: "åœ°ä¸­æµ·æ¸¯ç£", type: "spot" },
                    { time: "19:30", title: "å¤¢æƒ³ä¹‹æµ·", desc: "Believe! Sea of Dreams (åœ°ä¸­æµ·æ¸¯ç£)", type: "spot" },
                    { time: "20:30", title: "è–èª•ç…™ç«", desc: "Starbright Christmas", type: "spot" }
                ]},
                { day: 3, date: "11/28 (äº”)", loc: "é«˜å°¾å±±ãƒ»æ—¥æ¯”è°·", weather: "10Â°C", events: [
                    { time: "08:00", title: "å‰å¾€é«˜å°¾å±±", desc: "è³æ¥“åæ‰€", type: "spot", traffic: "äº¬ç‹ç·šä¸€æ—¥ç¥¨ + åœ°éµ72hr" },
                    { time: "16:30", title: "æ±äº¬ä¸­åŸæ—¥æ¯”è°·", desc: "è–èª•é»ç‡ˆ", type: "spot" }
                ]},
                { day: 4, date: "11/29 (å…­)", loc: "æ±äº¬ãƒ»è³æ¥“", weather: "11Â°C", events: [
                    { time: "08:00", title: "æ˜æ²»ç¥å®®å¤–è‹‘", desc: "éŠ€æå¤§é“", type: "spot", traffic: "åœ°éµ 72hr åˆ¸" },
                    { time: "11:00", title: "æ–°å®¿å¾¡è‹‘", desc: "å¾å¤–è‹‘æ•£æ­¥å‰å¾€ï¼Œæ—¥å¼åº­åœ’æ•£ç­–", type: "spot" },
                    { time: "14:00", title: "ä»£ä»£æœ¨å…¬åœ’", desc: "è‹¥æ™‚é–“å……è£•ï¼Œæ•£æ­¥å‰å¾€é‡é¤", type: "spot" },
                    { time: "18:30", title: "å…­ç¾©åœ’", desc: "å¤œæ¥“é»ç‡ˆ", type: "spot" }
                ]},
                { day: 5, date: "11/30 (æ—¥)", loc: "ä¸Šé‡ãƒ»å“ˆåˆ©æ³¢ç‰¹", weather: "12Â°C", events: [
                    { time: "08:00", title: "ä¸Šé‡æ©è³œå…¬åœ’", desc: "å…¬åœ’æ•£æ­¥", type: "spot", traffic: "ä½¿ç”¨åœ°éµ 72hr åˆ¸" },
                    { time: "11:00", title: "æ±äº¬å¤§å­¸ ä¸­å¤®é£Ÿå ‚", desc: "é«”é©—èµ¤é–€æ‹‰éºµ", type: "food" },
                    { time: "12:00", title: "å“ˆåˆ©æ³¢ç‰¹å½±åŸ", desc: "ç·´é¦¬å€ï¼Œéœ€é ç´„å…¥å ´ã€‚æ‹æ”ä»»å‹™ï¼šDonny is not free", type: "spot", key: "ticket_hp" }
                ]},
                { day: 6, date: "12/01 (ä¸€)", loc: "æ±äº¬ãƒ»è¿ªå£«å°¼æ¨‚åœ’", weather: "10Â°C", events: [
                    { time: "07:35", title: "æ­ä¹˜ Shuttle Bus", desc: "ç›´é”è¿ªå£«å°¼", type: "transport" },
                    { time: "08:30", title: "å…¥åœ’", desc: "æª¢æŸ¥éš¨èº«ç‰©å“", type: "spot", key: "ticket_land" },
                    { time: "12:45", title: "è–èª•ç¯€éŠè¡Œ", desc: "Disney Christmas Stories", type: "spot" },
                    { time: "15:25", title: "çœ¾å½©äº¤èéŠè¡Œ", desc: "Harmony in Color", type: "spot" },
                    { time: "17:45", title: "Reach for the Stars", desc: "åŸå ¡æŠ•å½±ç§€", type: "spot" },
                    { time: "19:00", title: "è–èª•ç¯€å¤œé–“éŠè¡Œ", desc: "é›»å­å¤§éŠè¡Œ", type: "spot" },
                    { time: "20:30", title: "è–èª•ç…™ç«", desc: "Starbright Christmas", type: "spot" }
                ]},
                { day: 7, date: "12/02 (äºŒ)", loc: "ç§»å‹•æ—¥ãƒ»ä»å·", weather: "6Â°C", events: [
                    { time: "11:00", title: "å’Œç·£ WAEN é€€æˆ¿", desc: "å‰å¾€æˆç”°æ©Ÿå ´", type: "hotel" },
                    { time: "12:50", title: "é£›å¾€é¦–çˆ¾", desc: "é¦–çˆ¾èˆªç©º RS702", type: "flight", key: "flight_2" },
                    { time: "15:35", title: "æŠµé”ä»å·æ©Ÿå ´ T2", desc: "è¾¦ç†å…¥å¢ƒ", type: "flight", key: "entry_kr" },
                    { time: "16:00", title: "INSPIRE Resort Check-in", desc: "è¿ä»•æŸåº¦å‡åŸ", type: "hotel", key: "hotel_2" }
                ]},
                { day: 8, date: "12/03 (ä¸‰)", loc: "ç§»å‹•è‡³å¼˜å¤§", weather: "5Â°C", events: [
                    { time: "11:00", title: "åº¦å‡æ‘é€€æˆ¿", desc: "", type: "hotel" },
                    { time: "æ¨è–¦", title: "åº¦å‡æ‘è¨­æ–½æ¨è–¦", desc: "<ul><li>æ¥µå…‰é“ (Aurora Way)</li><li>Splash Bay æ°´ä¸Šæ¨‚åœ’</li><li>Le Space å¤ªç©ºå±•è¦½</li><li>Rotunda åœ“å½¢å¤§å»³</li><li>Casino (å¤–åœ‹äººå°ˆç”¨)</li></ul>", type: "spot" },
                    { time: "PM", title: "å‰å¾€é¦–çˆ¾å¸‚å€", desc: "æ­ä¹˜ AREX æˆ–å·´å£«", type: "transport" },
                    { time: "Night", title: "Central Hongdae Check-in", desc: "Red Road Stay", type: "hotel", key: "hotel_3" }
                ]},
                { day: 9, date: "12/04 (å››)", loc: "é¦–çˆ¾ãƒ»çŒ›ç”·ç§€", weather: "4Â°C", events: [
                    { time: "AM", title: "Nanalogue", desc: "éŸ“ç³»å‰ªé«®é«”é©—", type: "spot" },
                    { time: "PM", title: "Beauty Play", desc: "ç¾å¦é«”é©—é¤¨", type: "spot" },
                    { time: "PM", title: "Studio Photobi", desc: "è­‰ä»¶ç…§/ä¿®åœ–", type: "spot" },
                    { time: "20:00", title: "TOUCH FIVE çŒ›ç”·ç§€", desc: "ææ—©30åˆ†æ›ç¥¨", type: "spot", key: "show_1" }
                ]},
                { day: 10, date: "12/05 (äº”)", loc: "é¦–çˆ¾ãƒ»é†«ç¾", weather: "3Â°C", events: [
                    { time: "11:00", title: "Abijou Clinic å¼˜å¤§", desc: "çš®è†šç®¡ç†", type: "spot" },
                    { time: "13:30", title: "KT&G æƒ³åƒåº­é™¢", desc: "å…”å­çƒé¾œå¿«é–ƒåº—", type: "spot" },
                    { time: "15:00", title: "Olive Young", desc: "å¤§æ¡è³¼", type: "food" },
                    { time: "16:30", title: "Meerkat Friends", desc: "ç‹ç´å’–å•¡å»³", type: "spot" }
                ]},
                { day: 11, date: "12/06 (å…­)", loc: "è¿”ç¨‹", weather: "15Â°C", events: [
                    { time: "11:00", title: "æ°‘å®¿é€€æˆ¿", desc: "", type: "hotel" },
                    { time: "13:50", title: "é£›å¾€å°åŒ—", desc: "é•·æ¦® BR155", type: "flight", key: "flight_3" },
                    { time: "15:35", title: "æŠµé”æ¾å±±æ©Ÿå ´", desc: "ç”œèœœçš„å®¶", type: "flight" }
                ]}
            ],
            logistics: {
                flights: [
                    { title: "å»ç¨‹ï¼šå°åŒ— â†’ æ±äº¬", code: "SL394", date: "11/26", time: "12:10 â 16:15", key: "flight_1" },
                    { title: "ä¸­ç¨‹ï¼šæ±äº¬ â†’ é¦–çˆ¾", code: "RS702", date: "12/02", time: "12:50 â 15:35", key: "flight_2" },
                    { title: "å›ç¨‹ï¼šé¦–çˆ¾ â†’ å°åŒ—", code: "BR155", date: "12/06", time: "13:50 â 15:35", key: "flight_3" }
                ],
                hotels: [
                    { name: "å’Œç·£ WAEN (æ±äº¬)", period: "6æ™š", room: "1-BR Apt", key: "hotel_1" },
                    { name: "INSPIRE Resort (ä»å·)", period: "1æ™š", room: "Double Queen", key: "hotel_2" },
                    { name: "Central Hongdae (é¦–çˆ¾)", period: "3æ™š", room: "2-BR Apt", key: "hotel_3" }
                ]
            }
        };

        const dasData = {
            sea: [
                { jp: "ã‚¢ãƒŠã¨ã‚¨ãƒ«ã‚µã®ãƒ•ãƒ­ãƒ¼ã‚ºãƒ³ã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼", en: "Anna and Elsa's Frozen Journey", zh: "å†°é›ªå¥‡ç·£ï¼šå®‰å¨œèˆ‡è‰¾èçš„å†°é›ªä¹‹æ—…" },
                { jp: "ãƒ©ãƒ—ãƒ³ãƒ„ã‚§ãƒ«ã®ãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«", en: "Rapunzel's Lantern Festival", zh: "æ¨‚ä½©å…¬ä¸»å¤©ç‡ˆç››æœƒ" },
                { jp: "ãƒ”ãƒ¼ã‚¿ãƒ¼ãƒ‘ãƒ³ã®ãƒãƒãƒ¼ãƒ©ãƒ³ãƒ‰ã‚¢ãƒ‰ãƒ™ãƒ³ãƒãƒ£ãƒ¼", en: "Peter Pan's Never Land Adventure", zh: "å½¼å¾—æ½˜çš„å¤¢å¹»å³¶æ­·éšªè¨˜" },
                { jp: "ã‚½ã‚¢ãƒªãƒ³ï¼šãƒ•ã‚¡ãƒ³ã‚¿ã‚¹ãƒ†ã‚£ãƒƒã‚¯ãƒ»ãƒ•ãƒ©ã‚¤ãƒˆ", en: "Soaring: Fantastic Flight", zh: "ç¿±ç¿”ï¼šå¤¢å¹»å¥‡èˆª" },
                { jp: "ãƒˆã‚¤ãƒ»ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ»ãƒãƒ‹ã‚¢ï¼", en: "Toy Story Mania!", zh: "ç©å…·ç¸½å‹•å“¡ç˜‹ç‹‚éŠæˆ²å±‹" },
                { jp: "ã‚»ãƒ³ã‚¿ãƒ¼ãƒ»ã‚ªãƒ–ãƒ»ã‚¸ãƒ»ã‚¢ãƒ¼ã‚¹", en: "Journey to the Center of the Earth", zh: "åœ°å¿ƒæ¢éšªä¹‹æ—…" }
            ],
            land: [
                { jp: "ç¾å¥³ã¨é‡ç£â€œé­”æ³•ã®ã‚‚ã®ãŒãŸã‚Šâ€", en: "Enchanted Tale of Beauty and the Beast", zh: "ç¾å¥³èˆ‡é‡ç¸ã€ŒåŸå ¡å¥‡ç·£ã€" },
                { jp: "ãƒ—ãƒ¼ã•ã‚“ã®ãƒãƒ‹ãƒ¼ãƒãƒ³ãƒˆ", en: "Pooh's Hunny Hunt", zh: "å°ç†Šç¶­å°¼çµèœœè¨˜" },
                { jp: "ãƒ™ã‚¤ãƒãƒƒã‚¯ã‚¹ã®ãƒãƒƒãƒ”ãƒ¼ãƒ©ã‚¤ãƒ‰", en: "The Happy Ride with Baymax", zh: "å¤§è‹±é›„å¤©åœ˜æ­¡æ¨‚ä¹‹æ—…" },
                { jp: "ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚ºãƒ»ã‚¤ãƒ³ã‚¯â€œãƒ©ã‚¤ãƒ‰ï¼†ã‚´ãƒ¼ã‚·ãƒ¼ã‚¯ï¼â€", en: "Monsters, Inc. Ride & Go Seek!", zh: "æ€ªç¸é›»åŠ›å…¬å¸ã€Œè¿·è—å·¡éŠè»Šã€" },
                { jp: "ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ãƒ»ãƒã‚¦ãƒ³ãƒ†ãƒ³", en: "Splash Mountain", zh: "é£›æ¿ºå±±" },
                { jp: "ãƒ“ãƒƒã‚°ã‚µãƒ³ãƒ€ãƒ¼ãƒ»ãƒã‚¦ãƒ³ãƒ†ãƒ³", en: "Big Thunder Mountain", zh: "å·¨é›·å±±" }
            ]
        };

        // --- CORE FUNCTIONS ---
        let currentDayIndex = 0;
        let activeKey = null;

        function init() {
            renderDayNav();
            renderDay(0);
            renderDAS('sea');
            renderInfoPage();
            renderShoppingList();
        }

        // --- View Switching ---
        function switchView(viewName, el) {
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active', 'das-active'));
            if (viewName === 'das') el.classList.add('das-active');
            else el.classList.add('active');

            ['view-itinerary', 'view-das', 'view-info', 'view-shopping'].forEach(v => {
                const elem = document.getElementById(v);
                if(elem) { elem.classList.add('hidden'); elem.style.display = 'none'; }
            });
            
            const target = document.getElementById('view-' + viewName);
            if (target) { 
                target.classList.remove('hidden'); 
                target.style.display = 'block'; 
            }
            if(viewName === 'info') renderInfoPage();
            window.scrollTo(0, 0);
        }

        // --- DAS Park Switching ---
        function switchPark(park) {
            renderDAS(park);
            const btnSea = document.getElementById('btn-sea');
            const btnLand = document.getElementById('btn-land');
            if (park === 'sea') {
                btnSea.className = 'park-btn active-sea'; btnLand.className = 'park-btn';
                document.querySelector('.speech-bubble').style.borderLeftColor = 'var(--sea-color)';
            } else {
                btnSea.className = 'park-btn'; btnLand.className = 'park-btn active-land';
                document.querySelector('.speech-bubble').style.borderLeftColor = 'var(--land-color)';
            }
        }

        function renderDAS(park) {
            const container = document.getElementById('das-list-container');
            let html = '';
            dasData[park].forEach(item => {
                html += `<div class="das-card"><div class="das-jp-name">${item.jp}</div><div class="das-sub-info">${item.en}</div><div class="das-sub-info">${item.zh}</div></div>`;
            });
            container.innerHTML = html;
        }

        // --- Itinerary Rendering ---
        function renderDayNav() {
            const navContainer = document.getElementById('day-nav-container');
            let html = '';
            tripData.days.forEach((day, index) => {
                html += `<button type="button" class="day-chip ${index === 0 ? 'active' : ''}" onclick="selectDay(${index}, this)">Day ${day.day}</button>`;
            });
            navContainer.innerHTML = html;
        }

        function selectDay(index, el) {
            currentDayIndex = index;
            document.querySelectorAll('.day-chip').forEach(chip => chip.classList.remove('active'));
            el.classList.add('active');
            renderDay(index);
        }

        function renderDay(index) {
            const dayData = tripData.days[index];
            document.getElementById('hero-date').innerText = `Day ${dayData.day} â€¢ ${dayData.date}`;
            document.getElementById('hero-location').innerHTML = dayData.loc.replace('ãƒ»', '<br>');
            
            const content = document.getElementById('timeline-content');
            let html = '';

            dayData.events.forEach(event => {
                let iconClass = 'fa-location-dot';
                if (event.type === 'flight') iconClass = 'fa-plane';
                if (event.type === 'hotel') iconClass = 'fa-bed';
                if (event.type === 'food') iconClass = 'fa-utensils';
                if (event.type === 'transport') iconClass = 'fa-train-subway';

                const mapQuery = encodeURIComponent(event.title + " " + dayData.loc.split('ãƒ»')[0]);
                const mapUrl = `https://www.google.com/maps/search/?api=1&query=${mapQuery}`;

                let metaBtn = '';
                if (event.key) {
                    const hasData = localStorage.getItem(event.key + '_text') || localStorage.getItem(event.key + '_img');
                    let label = "æ†‘è­‰";
                    if (event.key.includes('entry')) label = "å…¥å¢ƒ QR";
                    else if (event.key.includes('ticket')) label = "é–€ç¥¨ QR";
                    else if (event.key.includes('flight')) label = "æ©Ÿç¥¨";
                    else if (event.key.includes('hotel')) label = "ä½å®¿";

                    const btnText = hasData ? `æŸ¥çœ‹${label}` : `è¼¸å…¥${label}`;
                    const btnIcon = hasData ? 'fa-check-circle' : 'fa-pen-to-square';
                    const btnStyle = hasData ? 'color:var(--accent-color)' : '';
                    metaBtn = `<button class="icon-btn" type="button" style="${btnStyle}" onclick="openModal('${event.key}', '${event.title} ${label}')"><i class="fa-solid ${btnIcon}"></i> <span>${btnText}</span></button>`;
                }

                const trafficTag = event.traffic ? `<div class="traffic-tag"><i class="fa-solid fa-ticket"></i> ${event.traffic}</div>` : '';

                html += `
                <div class="timeline-item">
                    <div class="time-col">${event.time}</div>
                    <div class="card-col">
                        <div class="event-card ${event.type}">
                            <div class="card-header"><div class="card-title">${event.title}</div><i class="fa-solid ${iconClass}" style="color:#ddd;"></i></div>
                            <div class="card-desc">${event.desc}</div>
                            ${trafficTag}
                            <div class="action-row">
                                <a href="${mapUrl}" target="_blank" class="icon-btn"><i class="fa-solid fa-map-location"></i> <span>åœ°åœ–</span></a>
                                ${metaBtn}
                            </div>
                        </div>
                    </div>
                </div>`;
            });
            
            // Add Memo Section at the end of the day
            const memoKey = `memo_day_${index}`;
            const savedMemo = localStorage.getItem(memoKey) || "";
            html += `
                <div class="memo-container">
                    <div class="memo-title"><i class="fa-solid fa-pen-nib"></i> ä»Šæ—¥å‚™è¨» (è‡ªå‹•å„²å­˜)</div>
                    <textarea class="memo-textarea" placeholder="è¨˜éŒ„ä»Šå¤©çš„å¿ƒæƒ…ã€èŠ±è²»æˆ–æé†’..." oninput="saveMemo('${memoKey}', this.value)">${savedMemo}</textarea>
                </div>
            `;
            
            html += '<div style="height: 40px;"></div>';
            content.innerHTML = html;
        }

        function saveMemo(key, value) {
            localStorage.setItem(key, value);
        }

        // --- Shopping List Logic ---
        function getShoppingList() {
            return JSON.parse(localStorage.getItem('shopping_list') || '[]');
        }

        function saveShoppingList(list) {
            localStorage.setItem('shopping_list', JSON.stringify(list));
            renderShoppingList();
        }

        function addShoppingItem() {
            const input = document.getElementById('new-item-input');
            const text = input.value.trim();
            if (!text) return;
            
            const list = getShoppingList();
            list.push({ id: Date.now(), text: text, checked: false });
            saveShoppingList(list);
            input.value = '';
        }

        function toggleShoppingItem(id) {
            const list = getShoppingList();
            const item = list.find(i => i.id === id);
            if (item) {
                item.checked = !item.checked;
                saveShoppingList(list);
            }
        }

        function deleteShoppingItem(id) {
            const list = getShoppingList();
            const newList = list.filter(i => i.id !== id);
            saveShoppingList(newList);
        }

        function renderShoppingList() {
            const list = getShoppingList();
            const ul = document.getElementById('shopping-list');
            ul.innerHTML = '';
            
            if (list.length === 0) {
                ul.innerHTML = '<p style="text-align:center; color:#ccc; margin-top:20px;">ç›®å‰æ²’æœ‰è³¼ç‰©æ¸…å–®ï¼Œæ–°å¢ä¸€é …å§ï¼</p>';
                return;
            }

            list.forEach(item => {
                const checkedClass = item.checked ? 'checked' : '';
                const iconClass = item.checked ? 'fa-check' : '';
                
                ul.innerHTML += `
                <li class="shopping-item ${checkedClass}">
                    <div class="checkbox ${checkedClass}" onclick="toggleShoppingItem(${item.id})">
                        <i class="fa-solid ${iconClass}" style="font-size:0.8rem;"></i>
                    </div>
                    <div class="item-text">${item.text}</div>
                    <i class="fa-solid fa-trash delete-btn" onclick="deleteShoppingItem(${item.id})"></i>
                </li>`;
            });
        }

        // --- Info Page Rendering ---
        function renderInfoPage() {
            // Flights
            const fContainer = document.getElementById('flight-info-container');
            let fHtml = '';
            tripData.logistics.flights.forEach(f => {
                const hasData = localStorage.getItem(f.key + '_text') || localStorage.getItem(f.key + '_img');
                const btnClass = hasData ? "copy-btn set" : "copy-btn";
                const displayVal = hasData ? "å·²å„²å­˜" : "é»æ“Šè¨­å®š";

                fHtml += `
                <div class="info-card">
                    <div class="info-header"><span>${f.title}</span><i class="fa-solid fa-plane"></i></div>
                    <div class="info-row"><span class="info-label">èˆªç­</span> <span class="info-val">${f.code}</span></div>
                    <div class="info-row"><span class="info-label">æ™‚é–“</span> <span class="info-val" style="font-size:0.85rem">${f.time}</span></div>
                    <div class="info-row">
                        <span class="info-label">è¨‚ä½ä»£è™Ÿ</span> 
                        <div style="display:flex; align-items:center; gap:8px;">
                            <span class="info-val" style="font-size:0.8rem; color:#888">${displayVal}</span>
                            <button class="${btnClass}" type="button" onclick="openModal('${f.key}', 'èˆªç­æ†‘è­‰')"><i class="fa-solid fa-pen"></i></button>
                        </div>
                    </div>
                </div>`;
            });
            fContainer.innerHTML = fHtml;

            // Hotels
            const hContainer = document.getElementById('hotel-info-container');
            let hHtml = '';
            tripData.logistics.hotels.forEach(h => {
                const hasData = localStorage.getItem(h.key + '_text') || localStorage.getItem(h.key + '_img');
                const btnClass = hasData ? "copy-btn set" : "copy-btn";
                const displayVal = hasData ? "å·²å„²å­˜" : "é»æ“Šè¨­å®š";

                hHtml += `
                <div class="info-card">
                    <div class="info-header"><span>${h.name}</span><i class="fa-solid fa-hotel"></i></div>
                    <div class="info-row"><span class="info-label">å¤©æ•¸</span> <span class="info-val">${h.nights}</span></div>
                    <div class="info-row"><span class="info-label">æˆ¿å‹</span> <span class="info-val" style="font-size:0.85rem">${h.type}</span></div>
                    <div class="info-row">
                        <span class="info-label">è¨‚å–®ç·¨è™Ÿ</span> 
                        <div style="display:flex; align-items:center; gap:8px;">
                            <span class="info-val" style="font-size:0.8rem; color:#888">${displayVal}</span>
                            <button class="${btnClass}" type="button" onclick="openModal('${h.key}', 'ä½å®¿æ†‘è­‰')"><i class="fa-solid fa-pen"></i></button>
                        </div>
                    </div>
                </div>`;
            });
            hContainer.innerHTML = hHtml;
        }

        // --- LOCAL STORAGE & MODAL LOGIC ---
        function openModal(key, title) {
            activeKey = key;
            document.getElementById('modal-title').innerText = title;
            document.getElementById('secure-modal').style.display = 'flex';
            
            const savedText = localStorage.getItem(key + '_text') || '';
            const savedImg = localStorage.getItem(key + '_img') || '';
            
            document.getElementById('input-text').value = savedText;
            const imgPreview = document.getElementById('img-preview');
            
            if (savedImg) {
                imgPreview.src = savedImg;
                imgPreview.style.display = 'block';
            } else {
                imgPreview.style.display = 'none';
                imgPreview.src = '';
            }
            document.getElementById('input-file').value = '';
        }

        function previewImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById('img-preview');
                    img.src = e.target.result;
                    img.style.display = 'block';
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        function saveData() {
            if (!activeKey) return;
            
            const textVal = document.getElementById('input-text').value;
            const imgVal = document.getElementById('img-preview').src;
            
            if (textVal) localStorage.setItem(activeKey + '_text', textVal);
            else localStorage.removeItem(activeKey + '_text');
            
            if (document.getElementById('img-preview').style.display === 'block' && imgVal.startsWith('data:image')) {
                try {
                    localStorage.setItem(activeKey + '_img', imgVal);
                } catch (e) {
                    alert('åœ–ç‰‡æª”æ¡ˆå¤ªå¤§ï¼Œç€è¦½å™¨å­˜ä¸é€²å»ï¼\nè«‹æ”¹ç”¨ã€Œè¢å¹•æˆªåœ–ã€å¾Œå†ä¸Šå‚³ (æˆªåœ–å®¹é‡è¼ƒå°)ã€‚');
                    return;
                }
            } else {
                localStorage.removeItem(activeKey + '_img');
            }

            closeModal();
            
            if(document.getElementById('view-itinerary').style.display !== 'none') {
                renderDay(currentDayIndex);
            } else {
                renderInfoPage();
            }
        }

        function clearData() {
            if (!activeKey) return;
            if(confirm('ç¢ºå®šè¦æ¸…é™¤æ­¤ç­†è³‡æ–™å—ï¼Ÿ(æ‰‹æ©Ÿå…§çš„ç´€éŒ„å°‡è¢«åˆªé™¤)')) {
                localStorage.removeItem(activeKey + '_text');
                localStorage.removeItem(activeKey + '_img');
                
                document.getElementById('input-text').value = '';
                document.getElementById('img-preview').src = '';
                document.getElementById('img-preview').style.display = 'none';
                
                closeModal();
                if(document.getElementById('view-itinerary').style.display !== 'none') {
                    renderDay(currentDayIndex);
                } else {
                    renderInfoPage();
                }
            }
        }

        function closeModal() {
            document.getElementById('secure-modal').style.display = 'none';
        }

        function openFullMap() {
            window.open('https://www.google.com/maps/search/?api=1&query=Tokyo+Seoul+Trip', '_blank');
        }

        init();

    </script>
</body>
</html>
